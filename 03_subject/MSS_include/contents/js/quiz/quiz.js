"use strict";function switchStringNumListToArray(t,e){return t.replace("/ /g","").split(e).map(function(t){return parseInt(t)})}!function(){function s(t){var e,n=this;this.container=t.container,this.type=t.type,this.include=t.include,this.parent="inPage"===t.include?$ts.getEl("main",document,0):$ts.getEl("popup",document,0),this.name=this.container.getAttribute("data-quiz-name"),this.option=t.container.hasAttribute("data-option"),this.alert=t.container.hasAttribute("data-alert"),this.answerBtn=$ts.getEl("[data-answer-btn]",t.container,0),this.showTargetsAfterAnswer=$ts.getEl('[data-after-target="'+(this.name||this.type)+'"]',t.container),this.customCompleteCount=this.container.dataset.customCompleteCount?parseInt(this.container.dataset.customCompleteCount):null,this.startQuiz=function(){window.$run("$"+this.type,function(){switch(n.type){case"toggle":e=$toggle(n);break;case"check":e=$check(n);break;case"input":e=$input(n);break;case"ox":e=$ox(n);break;case"dragdrop":e=$dragdrop(n);break;case"dragDrop":(e=new $dragDrop(n)).init(s);break;case"drawline":e=$drawline(n);break;case"dragLine":(e=new $dragLine(n)).init(s)}window.$pm.array[n.include].quiz.push(e),e.QUIZ=n,e.name=n.name})},this.toggleAnswerBtn=function(){this.answerBtn&&(this.answerBtn.classList.contains("reset")?this.reset():this.showAnswer())},this.checkComplete=function(t){e.totalCompleteCount===e.completeCount?(this.container.classList.add("complete"),this.answerBtn&&this.answerBtn.classList.add("reset"),t&&t.complete&&t.complete(n)):(this.container.classList.remove("complete"),this.answerBtn&&this.answerBtn.classList.remove("reset"),t&&t.reset&&t.reset(n)),this.chain&&this.chain.checkComplete(this)},this.showAnswer=function(){e.showAnswer(),this.answerBtn&&this.answerBtn.classList.add("reset"),this.showTargetsAfterAnswer&&0<this.showTargetsAfterAnswer.length&&this.showTargetsAfterAnswer.forEach(function(t){t.classList.add("on")}),window.$callBack&&window.$callBack.viewAnswer&&window.$callBack.viewAnswer(e)},this.reset=function(){e.reset(),this.answerBtn&&this.answerBtn.classList.remove("reset"),this.showTargetsAfterAnswer&&0<this.showTargetsAfterAnswer.length&&this.showTargetsAfterAnswer.forEach(function(t){t.classList.remove("on")}),window.$callBack&&window.$callBack.hideAnswer&&window.$callBack.hideAnswer(e)},this.getIndex=function(t){return t.obj.getAttribute("data-"+t.type+"-obj")},this.getTarget=function(t){var e,n=[];for(e in t.target)t.target[e].getAttribute("data-"+t.type+"-target")==t.index&&n.push(t.target[e]);return n},this.set=function(){if(this.startQuiz(),this.answerBtn&&(this.answerBtn.addEventListener("click",this.toggleAnswerBtn.bind(this)),$ts.addHoverEvents(this.answerBtn),this.answerBtn.addEventListener("click",$efSound.click)),this.option){this.option={};var t,e=this.container.getAttribute("data-option").replace(/ /g,"");for(t in e=e.split(","))this.option[e[t]]=!0}},this.set()}$ts.loadScriptFile("../../../MSS_include/libs/js/dragdropCore.js"),$ts.loadScriptFile("../../../MSS_include/contents/js/quiz/dragDrop.js"),$ts.loadScriptFile("../../../MSS_include/contents/js/quiz/dragLine.js"),window.$quiz=function(t){return new s(t)}}(),function(){function e(o){var a=this;function n(t,e){if(t.classList.contains("complete"))o.option.toggle&&(!function t(e){var n=o.getIndex({obj:e,type:"toggle"}),s=o.getTarget({index:n,type:"toggle",target:a.target});a.completeCount--;e.classList.remove("complete");for(var i in s)s[i].classList.remove("on"),s[i].classList.contains("complete")&&t(s[i])}(t),window.$callBack&&window.$callBack.toggleBack&&window.$callBack.toggleBack({quiz:a,curObj:t,curTarget:e}));else{if(t.hasAttribute("data-group-index"))for(var n=a.obj,s=0;s<n.length;s++)t.getAttribute("data-group-index")===n[s].getAttribute("data-group-index")&&(a.completeCount++,n[s].classList.add("complete"));else for(var s in a.completeCount++,t.classList.add("complete"),e)e[s].classList.add("on");window.$callBack&&window.$callBack.toggleClick&&window.$callBack.toggleClick({quiz:a,curObj:t,curTarget:e})}o.checkComplete()}this.container=o.container,this.obj=$ts.getEl("[data-"+o.type+"-obj]",this.container),this.target=$ts.getEl("[data-"+o.type+"-target]",this.container),this.totalCompleteCount=o.customCompleteCount||this.obj.length,this.completeCount=0,this.showAnswer=function(){for(var t in this.completeCount=this.totalCompleteCount,this.container.classList.add("complete"),this.obj)this.obj[t].classList.add("complete");for(var t in this.target)this.target[t].classList.add("on");window.$callBack&&window.$callBack.toggleAnswer&&window.$callBack.toggleAnswer(a)},this.reset=function(){for(var t in this.completeCount=0,this.container.classList.remove("complete"),this.obj)this.obj[t].classList.remove("complete");for(var t in this.target)this.target[t].classList.remove("on");o.answerBtn&&o.answerBtn.classList.remove("reset"),window.$callBack&&window.$callBack.toggleReset&&window.$callBack.toggleReset(a)},function(){for(var t in a.obj){var e=o.getIndex({obj:a.obj[t],type:"toggle"}),e=o.getTarget({index:e,type:"toggle",target:a.target});a.obj[t].addEventListener("click",n.bind(a,a.obj[t],e)),$ts.addHoverEvents(a.obj[t]),a.obj[t].addEventListener("click",$efSound.click)}}()}window.$toggle=function(t){return new e(t)}}(),function(){function e(o){var a=this;function n(t,e){if(a.reset(),t.hasAttribute("data-answer"))for(var n in a.completeCount++,e)e[n].classList.add("on");else for(var n in e)e[n].classList.add("on");window.$callBack&&window.$callBack.checkClick&&window.$callBack.checkClick({quiz:a,curObj:t,curTarget:e}),o.checkComplete({complete:c,reset:r})}function s(t,e){if(t.classList.contains("checked"))i(t);else if(t.classList.contains("complete"))i(t);else{for(var n in t.hasAttribute("data-answer")&&a.completeCount++,t.classList.add("checked"),e)e[n].classList.add("on");window.$callBack&&window.$callBack.checkClick&&window.$callBack.checkClick({quiz:a,curObj:t,curTarget:e})}o.checkComplete({complete:c,reset:r})}function i(t){var e,n=o.getIndex({obj:t,type:"check"}),s=o.getTarget({index:n,type:"check",target:a.target});for(e in t.hasAttribute("data-answer")&&a.completeCount--,t.classList.contains("complete")&&t.classList.remove("complete"),t.classList.remove("checked"),s)s[e].classList.remove("on"),s[e].classList.contains("checked")&&i(s[e])}function c(){for(var t in a.obj)a.obj[t].hasAttribute("data-answer")&&(a.obj[t].classList.add("checked"),a.obj[t].classList.add("complete"))}function r(){for(var t in a.obj)a.obj[t].hasAttribute("data-answer")&&a.obj[t].classList.remove("complete")}this.container=o.container,this.obj=$ts.getEl("[data-"+o.type+"-obj]",this.container),this.target=$ts.getEl("[data-"+o.type+"-target]",this.container),this.totalCompleteCount=$ts.getEl("[data-answer]",this.container).length,this.completeCount=0,this.showAnswer=function(){this.completeCount=this.totalCompleteCount,this.container.classList.add("complete");var t,e=[];for(t in this.obj)if(this.obj[t].hasAttribute("data-answer")){var n,s=o.getIndex({obj:a.obj[t],type:"check"}),i=o.getTarget({index:s,type:"check",target:a.target});for(n in this.obj[t].classList.add("complete"),this.obj[t].classList.add("checked"),i)e.push(i[n])}for(t in e)e[t].classList.add("on");window.$callBack&&window.$callBack.checkAnswer&&window.$callBack.checkAnswer(a)},this.reset=function(){for(var t in this.completeCount=0,this.container.classList.remove("complete"),this.obj)this.obj[t].classList.remove("complete"),this.obj[t].classList.remove("checked");for(var t in this.target)this.target[t].classList.remove("on");window.$callBack&&window.$callBack.checkReset&&window.$callBack.checkReset(a)},function(){for(var t in a.obj){var e=o.getIndex({obj:a.obj[t],type:"check"}),e=o.getTarget({index:e,type:"check",target:a.target});1===a.totalCompleteCount?a.obj[t].addEventListener("click",n.bind(this,a.obj[t],e)):a.obj[t].addEventListener("click",s.bind(this,a.obj[t],e)),$ts.addHoverEvents(a.obj[t]),a.obj[t].addEventListener("click",$efSound.click)}}()}window.$check=function(t){return new e(t)}}(),function(){function e(t){var e=this;this.container=t.container,this.obj=$ts.getEl("[data-"+t.type+"-obj]",this.container),this.showAnswer=function(){this.obj.forEach(function(t){var e=t.getAttribute("data-answer");e&&(t.value=e,t.classList.add("answerMode"),t.setAttribute("readonly",""))}),this.container.classList.add("complete"),window.$callBack&&window.$callBack.inputAnswer&&window.$callBack.inputAnswer(e)},this.reset=function(){this.obj.forEach(function(t){var e=t.getAttribute("data-answer");t.value="",e&&(t.classList.remove("answerMode"),t.removeAttribute("readonly",""))}),this.container.classList.remove("complete"),window.$callBack&&window.$callBack.inputReset&&window.$callBack.inputReset(e)},e.obj.forEach(function(t){var e;t.hasAttribute("placeholder")&&(e=t.getAttribute("placeholder"),t.setAttribute("onfocus","placeholder=''"),t.setAttribute("onblur","placeholder='"+e+"'")),t.setAttribute("autocomplete","off"),t.addEventListener("focus",function(){this.classList.add("onFocus")}),t.addEventListener("blur",function(){this.classList.remove("onFocus"),""!==t.value?this.classList.add("offBg"):this.classList.remove("offBg")})})}window.$input=function(t){return new e(t)}}(),function(){function e(o){var a=this;function n(t,e){if(1===a.totalCompleteCount&&a.reset(),t.hasAttribute("data-answer")&&!t.classList.contains("complete")){for(var n in a.completeCount++,t.classList.add("complete"),e)e[n].classList.add("on");o.alert&&(a.alertPopup.setAttribute("class","alert_popup on correct"),s()),o.option&&o.option.answerSound&&$efSound.correct(),window.$callBack&&window.$callBack.oxCorrect&&window.$callBack.oxCorrect({quiz:a,curObj:t,curTarget:e})}else{for(var n in e)e[n].classList.add("on"),o.option&&o.option.hide&&function(t){setTimeout(function(){t.classList.remove("on")},500)}(e[n]);o.alert&&(a.alertPopup.setAttribute("class","alert_popup on incorrect"),s()),o.option&&o.option.answerSound&&window.$efSound.incorrect(),window.$callBack&&window.$callBack.oxIncorrect&&window.$callBack.oxIncorrect({quiz:a,curObj:t,curTarget:e})}o.checkComplete()}function s(){setTimeout(function(){a.alertPopup.setAttribute("class","alert_popup")},2400)}this.container=o.container,this.obj=$ts.getEl("[data-"+o.type+"-obj]",this.container),this.target=$ts.getEl("[data-"+o.type+"-target]",this.container),this.totalCompleteCount=o.customCompleteCount||$ts.getEl("[data-answer]",this.container).length,this.completeCount=0,o.alert&&(this.alertPopup=$ts.ce({tag:"div",class:"alert_popup",parent:this.container})),this.showAnswer=function(){this.completeCount=this.totalCompleteCount,this.container.classList.add("complete");var t,e=[];for(t in this.obj)if(this.obj[t].hasAttribute("data-answer")){var n,s=o.getIndex({obj:this.obj[t],type:"ox"}),i=o.getTarget({index:s,type:"ox",target:this.target});for(n in this.obj[t].classList.add("complete"),i)e.push(i[n])}for(t in e)e[t].classList.add("on");window.$callBack&&window.$callBack.oxAnswer&&window.$callBack.oxAnswer(a)},this.reset=function(){for(var t in this.completeCount=0,this.container.classList.remove("complete"),this.obj)this.obj[t].classList.remove("complete");for(var t in this.target)this.target[t].classList.remove("on");window.$callBack&&window.$callBack.oxReset&&window.$callBack.oxReset(a)},function(){for(var t in a.obj){var e=o.getIndex({obj:a.obj[t],type:"ox"}),e=o.getTarget({index:e,type:"ox",target:a.target});a.obj[t].addEventListener("click",n.bind(this,a.obj[t],e)),$ts.addHoverEvents(a.obj[t]),o.option&&o.option.answerSound||a.obj[t].addEventListener("click",$efSound.click)}}()}window.$ox=function(t){return new e(t)}}(),function(){function e(e){var n=this,s=$ts.getEl("[data-drag-drop-container]",e.container,0),t=$ts.getEl("[data-drag-element]",s),i=$ts.getEl("[data-drop-area-element]",s),o=new DragDrop({containerElement:s,dragElements:t,dropAreaElements:i});o.initialize(),this.container=s,this.obj=t,this.target=i,this.totalCompleteCount=t.length,this.completeCount=0,o.endCallback=function(t){t.isCorrect?(n.completeCount++,$efSound.correct(),window.$callBack&&window.$callBack.dragdropCorrect&&window.$callBack.dragdropCorrect(n)):($efSound.incorrect(),window.$callBack&&window.$callBack.dragdropIncorrect&&window.$callBack.dragdropIncorrect(n)),n.totalCompleteCount===n.completeCount&&s.classList.add("complete"),e.checkComplete()},this.showAnswer=function(){s.classList.add("complete"),n.completeCount=this.totalCompleteCount,o.answerAll(),window.$callBack&&window.$callBack.dragdropAnswer&&window.$callBack.dragdropAnswer(n)},this.reset=function(){s.classList.remove("complete"),n.completeCount=0,o.resetAll(),window.$callBack&&window.$callBack.dragdropReset&&window.$callBack.dragdropReset(n)}}window.$dragdrop=function(t){return new e(t)}}(),function(){function e(i){this.answers=[],this.dots=[],this.btns=[],this.svg=void 0,this.lines=[],Object.defineProperties(this,{len_dots:{get:function(){return this.dots.length}},len_answers:{get:function(){return this.answers.length}},allAnswered:{get:function(){return this.lines.every(function(t){return"complete"===t.getAttribute("data-complete")})}}}),this.initiate=function(){this.setAnswers(),this.setDots(),this.setBtns(),this.setSvg()},this.setAnswers=function(){var n,t=i.container.dataset.drawLineAnswers;(t=t.split(" ")).forEach(function(t){var e=[];n=n||[],e=(e=t.split(",")).map(function(t){return parseInt(t)}),n.push(e)}),this.answers=n},this.setDots=function(){this.dots=$ts.getEl("[data-draw-line-dot]"),this.dots.forEach(function(t){t.dotIndex=parseInt(t.dataset.drawLineDot)})},this.setBtns=function(){var n=this;this.btns=$ts.getEl("[data-draw-line-btn]"),this.btns.forEach(function(t){t.answerIndex=parseInt(t.dataset.drawLineBtn),t.addEventListener("click",function(t){for(var e=t.target;!e.hasAttribute("data-draw-line-btn");)e=e.parentElement;e.dataset.complete||(t=n.answers[e.answerIndex-1],n.answers[e.answerIndex-1].answered=!0,n.drawLine(t),n.completeBtn(e),n.allAnswered&&i.toggleAnswerBtn())},!1),t.addEventListener("click",$efSound.click)})},this.setSvg=function(){var t,e,n=document.createElementNS("http://www.w3.org/2000/svg","g");n.style.stroke="#e25050",n.style.strokeWidth=3;for(var s=0;s<this.len_answers;s++)t=document.createElementNS("http://www.w3.org/2000/svg","line"),n.appendChild(t),this.lines.push(t);(e=document.createElementNS("http://www.w3.org/2000/svg","svg")).style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.width="100%",e.style.height="100%",e.style.pointerEvents="none",i.container.insertBefore(e,i.container.children[0]),e.appendChild(n)},this.drawLine=function(t){var e,n,s=this,i=[];t.forEach(function(t){i.push(s.findDot(t))}),e=i.map(function(t){return s.getDotPosition(t)}),this.lines.forEach(function(t){n||"complete"!==t.getAttribute("data-complete")&&(t.setAttribute("x1",e[0].x),t.setAttribute("x2",e[1].x),t.setAttribute("y1",e[0].y),t.setAttribute("y2",e[1].y),t.setAttribute("data-complete","complete"),n=!0)})},this.findDot=function(t){for(var e=0;e<this.len_dots;e++)if(t===this.dots[e].dotIndex)return this.dots[e]},this.getDotPosition=function(t){var e=$ts.getSize(t),t=$ts.getSize(i.container);return{x:e.left-t.left+e.width/2,y:e.top-t.top+e.width/2}},this.drawLines=function(){var e=this;this.answers.forEach(function(t){t.answered||(e.drawLine(t),t.answered=!0)})},this.resetLine=function(t){t.setAttribute("x1","0"),t.setAttribute("x2","0"),t.setAttribute("y1","0"),t.setAttribute("y2","0"),t.setAttribute("data-complete","")},this.resetLines=function(){var e=this;this.lines.forEach(function(t){e.resetLine(t)})},this.completeBtn=function(t){t.classList.add("complete"),t.dataset.complete="complete",t.style.pointerEvents="none"},this.completeBtns=function(){var e=this;this.btns.forEach(function(t){e.completeBtn(t)})},this.resetBtn=function(t){t.classList.remove("complete"),t.dataset.complete="",t.style.pointerEvents="auto"},this.resetBtns=function(){var e=this;this.btns.forEach(function(t){e.resetBtn(t)})},this.checkAllAnswered=function(){return this.lines.every(function(t){return"complete"===t.dataset.complete})},this.showAnswer=function(){this.completeBtns(),this.drawLines()},this.reset=function(){this.resetBtns(),this.resetLines(),this.answers.forEach(function(t){t.answered=!1})},this.initiate()}function n(t){i(t,!1)}function s(t){t.forEach(n)}function i(t,e){t.classList[e?"add":"remove"]("on")}function o(t){return window.$ts.getEl(".js-select",t)}var t;window.$drawline=function(t){return new e(t)},window.$selectCorrectQuiz=function(){var t=window.$ts.getEl(".js-selectCorrectQuiz");if(!t.length)return{resetAll:function(){}};var e=t.map(function(t){var n=window.$ts.getEl(".js-select",t);function s(t){return t.classList.contains("js-correct")}function e(t){s(t.target)?(window.$efSound.correct(),i(!0)):(window.$efSound.incorrect(),i(!1))}function i(e){n.forEach(function(t){s(t)&&t.classList[e?"add":"remove"]("on")})}return n.forEach(function(t){t.addEventListener("click",e)}),{reset:function(){i(!1)}}});return{resetAll:function(){e.forEach(function(t){t.reset()})}}}(),window.$oxSelectQuiz=(t=window.$ts.getEl(".js-oxSelect")).length?(t.forEach(function(t){var e=o(t);e.forEach(function(t){t.addEventListener("click",function(t){t=t.target;s(e),i(t,!0)})})}),{resetAll:function(){t.map(o).forEach(function(t){s(t)})}}):{resetAll:function(){}}}();