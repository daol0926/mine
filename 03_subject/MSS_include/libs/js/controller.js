"use strict";!function(){var e="isFullscreen",i="isStopped";function n(t){var r=this;this.container=t.container,this.mediaType=t.mediaType||"audio",this.controlType=t.controlType||"control",this.mediaArray=$ts.getEl(this.mediaType,this.container),this.mediaBtns=t.mediaBtns,this.multiMode=1<this.mediaArray.length,this.media=this.mediaArray[0],this.media.setAttribute("allowfullscreen",""),this.index=t.index||0,this.thumbnail="video"===this.mediaType,this.screenPlayBtn="video"===this.mediaType,this.autoPlay=this.media.hasAttribute("data-auto-play"),this.autoPlay&&(this.playPage=t.container.hasAttribute("data-current-page")?t.container.getAttribute("data-current-page"):1),this.mediaSync=!!t.container.hasAttribute("data-sync")&&t.container.getAttribute("data-sync"),this.isPlaying=!1,this.caption=!!t.container.hasAttribute("data-media-caption"),this.fullMode=!!t.container.hasAttribute("data-media-full"),this.close=!!t.container.hasAttribute("data-media-close"),this.volume=1,this.pageIndex=1,this.callBack=t.callBack||null,this.RATE=0,this.SHOW_CONTROLS_ON_FULLSIZE=this.container.hasAttribute("data-show-controls-on-fullsize"),this.hover={TIMEOUT_DELAY:2e3,CLASSNAME_HOVERED:"isHovered",control:void 0,hideTimeoutId:void 0,get isHovered(){return this.control.container.classList.contains(this.CLASSNAME_HOVERED)},initiate:function(t){this.control=t.control,this.addEvents()},addEvents:function(){var t=this.control.container;t.addEventListener("mousemove",this.moveEventHandler.bind(this),!1),t.addEventListener("click",this.clickEventHandler.bind(this),!1)},turnOnHover:function(){this.control.container.classList.add(this.CLASSNAME_HOVERED)},turnOffHover:function(){this.control.container.classList.remove(this.CLASSNAME_HOVERED)},startHideTimeout:function(){this.hideTimeoutId=setTimeout(this.hideTimeoutFnc.bind(this),this.TIMEOUT_DELAY)},stopHideTimeout:function(){clearTimeout(this.hideTimeoutId)},hideTimeoutFnc:function(){this.turnOffHover()},moveEventHandler:function(){this.turnOnHover(),this.stopHideTimeout(),this.startHideTimeout()},clickEventHandler:function(){this.turnOnHover(),this.stopHideTimeout(),this.startHideTimeout()}},this.hover.initiate({control:this}),Object.defineProperties(this,{fullscreenelement:{get:function(){return document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement||document.fullscreenElement||null}},isTouch:{get:function(){return/Android/i.test(navigator.userAgent)?"android":/iPhone|iPad|iPod/i.test(navigator.userAgent)?"ios":!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)}},duration:{get:function(){return this.media.duration||this.mediaDuration}},durSec:{get:function(){return Math.floor(this.duration%60)}},durMin:{get:function(){return Math.floor(this.duration/60)}},currTime:{get:function(){return this.media.currentTime},set:function(t){this.media.currentTime&&(this.media.currentTime=t)}},currSec:{get:function(){return Math.floor(this.currTime%60)}},currMin:{get:function(){return Math.floor(this.currTime/60)}},curDurRate:{get:function(){return this.currTime/this.duration}},barSize:{get:function(){return this.handleBar&&this.handleBar.getBoundingClientRect()}},barWidth:{get:function(){return this.barSize.right-this.barSize.left}},isFullScreen:{get:function(){return this.container.classList.contains(e)}}});t.callBack;this.create=function(){return this.controller=$ts.ce({tag:"div",class:"controller",parent:this.container}),this.playBtn=$ts.ce({tag:"div",class:"playBtn",parent:this.controller,attr:{title:"재생"}}),this.pauseBtn=$ts.ce({tag:"div",class:"pauseBtn",parent:this.controller,attr:{title:"일시 정지"}}),this.stopBtn=$ts.ce({tag:"div",class:"stopBtn",parent:this.controller,attr:{title:"정지"}}),this.handleBar=$ts.ce({tag:"div",class:"handleBar",parent:this.controller}),this.handleColorBar=$ts.ce({tag:"div",class:"handleColorBar",parent:this.handleBar}),this.handler=$ts.ce({tag:"div",class:"handler",parent:this.handleBar}),this.timeContainer=$ts.ce({tag:"div",class:"timeContainer",parent:this.controller}),this.curTime=$ts.ce({tag:"div",class:"curTime",parent:this.timeContainer}),this.totalTime=$ts.ce({tag:"div",class:"totalTime",parent:this.timeContainer}),$volume2({parent:this.controller,media:this.media}),"audio"!==this.mediaType&&(this.fullMode&&(this.fullScreenBtn=$ts.ce({tag:"div",class:"fullScreenBtn",parent:this.controller,attr:{title:"전체 화면"}})),this.caption&&(this.captionBtn=$ts.ce({tag:"div",class:"captionBtn",parent:this.controller,attr:{title:"자막"}})),this.close&&(this.closeBtn=$ts.ce({tag:"div",class:"closeBtn",parent:this.container,attr:{title:"닫기"}}))),this},this.addEvent=function(){if("video"===this.mediaType&&(document.addEventListener("fullscreenchange",this.fullScreenHandler,!1),document.addEventListener("webkitfullscreenchange",this.fullScreenHandler,!1),document.addEventListener("mozfullscreenchange",this.fullScreenHandler,!1),document.addEventListener("MSFullscreenChange",this.fullScreenHandler,!1),this.media.addEventListener("timeupdate",this.onTimeupdate.bind(this),!1)),this.playBtn.addEventListener("click",this.play.bind(this)),this.pauseBtn.addEventListener("click",this.pause.bind(this,this.pauseBtn)),this.stopBtn.addEventListener("click",this.stop.bind(this,this.stopBtn)),this.muteBtn&&(this.muteBtn.addEventListener("click",this.mute.bind(this,this.muteBtn)),this.muteBtn.addEventListener("click",$efSound.click),$ts.addHoverEvents(this.muteBtn)),$ts.addHoverEvents(this.playBtn),$ts.addHoverEvents(this.pauseBtn),$ts.addHoverEvents(this.stopBtn),this.playBtn.addEventListener("click",$efSound.click),this.pauseBtn.addEventListener("click",$efSound.click),this.stopBtn.addEventListener("click",$efSound.click),this.closeBtn&&(this.closeBtn.addEventListener("click",this.close.bind(this,this.closeBtn)),$ts.addHoverEvents(this.closeBtn),this.closeBtn.addEventListener("click",$efSound.click)),1<this.mediaArray.length&&this.mediaBtns)for(var t in this.mediaBtns)this.mediaBtns[t].addEventListener("click",this.changeMedia.bind(this,this.mediaBtns[t])),$ts.addHoverEvents(this.mediaBtns[t]),1==this.mediaBtns[t].getAttribute("data-media-btn")&&this.mediaBtns[t].classList.add("on"),this.mediaBtns[t].addEventListener("click",$efSound.click);"speaker"===this.controlType&&this.speaker&&(this.speaker.addEventListener("click",this.speakerPlay.bind(this)),$ts.addHoverEvents(this.speaker),this.speaker.addEventListener("click",$efSound.click)),this.handleBar.addEventListener("click",this.clickBar.bind(this)),this.handler.addEventListener("mousedown",this.dragHandler.bind(this)),this.handler.addEventListener("touchstart",this.dragHandler.bind(this)),"audio"!==this.mediaType&&this.fullMode&&(this.fullScreenBtn.addEventListener("click",this.fullScreen.bind(this)),$ts.addHoverEvents(this.fullScreenBtn))},this.fullScreen=function(){var t=this.container;this.isFullScreen?(document.exitFullscreen?document.exitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen(),this.fullScreenBtn.setAttribute("title","전체 화면")):(this.fullScreenBtn.setAttribute("title","이전 화면"),t.requestFullscreen?t.requestFullscreen():t.msRequestFullscreen?(this.controlsOn(),t.msRequestFullscreen()):t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullscreen?t.webkitRequestFullscreen():t.webkitEnterFullScreen&&t.webkitEnterFullScreen(),"ios"===this.isTouch&&window.setTimeout(function(){r.isPlayOff()}))},this.fullScreenHandler=function(){r.fullscreenelement?(r.fullScreenOn(),r.fullScreenBtn.setAttribute("title","이전 화면")):(r.fullScreenOff(),r.fullScreenBtn.setAttribute("title","전체 화면"))},this.timer=function(){var t="audio"===this.mediaType?function(t){return t.toString()}:e;function e(t){return t<10?"0"+t:t.toString()}this.curTime.innerHTML=t(this.currMin)+":"+e(this.currSec),this.totalTime.innerHTML=t(this.durMin)+":"+e(this.durSec)},this.getData=function(){var t={};return t.barSize=this.handleBar.getBoundingClientRect(),t.barTotalSize=t.barSize.right-t.barSize.left,t.handlerWidth=this.handler.getBoundingClientRect().width/2,t},this.resetMediaBtn=function(){for(var t in this.mediaBtns)this.mediaBtns[t].classList.remove("on")},this.changeMedia=function(t){var e,i=t.getAttribute("data-media-btn");for(e in this.stop(),this.resetMediaBtn(),t.classList.add("on"),this.mediaArray)if(this.mediaArray[e].getAttribute("data-media-index")==i){this.media=this.mediaArray[e],this.mediaArray[e].removeEventListener("ended",this.stop.bind(this));break}this.timer(),this.media.addEventListener("ended",this.stop.bind(this))},this.speakerPlay=function(){this.speaker.hasAttribute("data-speaker-option")&&"play"==this.speaker.getAttribute("data-speaker-option")&&(this.stop(),setTimeout(function(){this.play(),this.speaker.classList.add("on"),this.currentTime="0"},100)),this.isPlay?(this.stop(),this.speaker.classList.remove("on")):(this.play(),this.speaker.classList.add("on"))},this.playing=function(){this.timeUpdate=setInterval(function(){2===this.media.readyState&&(window.temp_currTime2=this.currTime,this.stop(),this.currTime=window.temp_currTime2,this.play());r.changeHandlerPosition(r.curDurRate)}.bind(this),100)},this.offBtn=function(){this.isPlay=!1,this.isPlayOff()},this.play=function(){this.callBack&&this.callBack.play&&this.callBack.play(this),this.isPlaying=!0,this.offBtn(),this.isPlayOn(),"video"===this.mediaType&&this.thumbnail.classList.add("off"),this.container.classList.remove("pause"),this.media.currentTime=this.currTime,this.media.play(),this.playing()},this.pause=function(t){this.offBtn(),this.media.pause(),this.isPlaying=!1,clearInterval(this.timeUpdate),this.callBack&&this.callBack.pause&&this.callBack.pause(this)},this.close=function(){this.stop(),this.callBack&&this.callBack.close&&this.callBack.close(this)},this.stop=function(){this.isPlaying=!1,this.container.classList.remove("pause"),"speaker"===this.controlType&&this.speaker.classList.remove("on"),this.offBtn(),this.media.pause(),this.media.currentTime&&(this.media.currentTime=0),this.thumbnail&&this.thumbnail.classList.remove("off"),this.changeCurTime(0),this.changeHandlerPosition(0),clearInterval(this.timeUpdate),this.callBack&&this.callBack.stop&&this.callBack.stop(this)},this.mute=function(t){t.classList.contains("on")?(t.classList.remove("on"),this.media.muted=!1):(t.classList.add("on"),this.media.muted=!0)},this.clickBar=function(t){var t=("touchstart"===t.type?t.touches[0]:t).clientX,t=this.getRateByBarEventX(t);this.changeHandlerPosition(t),this.changeCurTime(t)},this.dragHandler=function(t){var e,i,n=this.media;function s(t){e=("touchmove"===t.type?t.touches[0]:t).clientX,i=r.getRateByBarEventX(e),n.pause(),r.changeHandlerPosition(i),r.changeCurTime(i)}function a(){document.removeEventListener("mousemove",s),document.removeEventListener("touchmove",s),document.removeEventListener("mouseup",a),document.removeEventListener("touchend",a),1<=i?r.stop():r.isPlaying&&n.play()}e=("touchstart"===t.type?t.touches[0]:t).clientX,i=this.getRateByBarEventX(e),document.addEventListener("mousemove",s),document.addEventListener("touchmove",s),document.addEventListener("mouseup",a),document.addEventListener("touchend",a),this.changeHandlerPosition(i),this.changeCurTime(i)},this.getRateByBarEventX=function(t){return(t-this.barSize.left)/r.barWidth},this.changeHandlerPosition=function(t){t=t<=0?"0":1<=t?(this.barWidth,$pm.zoomRate,"100%"):(this.barWidth,$pm.zoomRate,100*t+"%");this.handler.style.transform="translateX(-50%)",this.handler.style.left=t,this.handleColorBar.style.width=t,this.timer()},this.changeCurTime=function(t){var e=isNaN(this.media.duration)?this.mediaDuration:this.media.duration,i=t<=0,n=1<=t;!this.currTime&&isNaN(this.currTime)||(i?this.currTime=0:n?this.currTime=e:(this.currTime=e*t,this.media.currentTime=e*t)),this.timer()},this.setBookmark=function(t){var i=this;this.setBookmark.bind(this),this.BOOKMARK_DATA=t;this.BOOKMARK_DATA&&this.BOOKMARK_DATA.forEach(function(t){var e=$ts.ce({tag:"div",class:"bookmark",parent:i.controller}),t=+(t.time/i.duration).toFixed(2),t=i.handleBar.offsetWidth*t;e.style.left="".concat(t+i.handleBar.offsetLeft,"px"),e.addEventListener("click",function(t){t=t.target,t=parseInt(t.style.left.replace("px",""));t-=i.handleBar.offsetLeft,i.RATE=t/i.handleBar.offsetWidth,i.changeHandlerPosition(i.RATE),i.changeCurTime(i.RATE),i.timer()})})},this.startAutoPlay=function(t){this.setTimeAutoPlay=setTimeout(function(){r.play()},t)},this.initThumnail=function(){var t,e;this.thumbnail&&(t=$ts.ce({tag:"div",class:"mediaThumbnail",parent:this.container}),e=this.media.getAttribute("poster"),t.style.background="url("+e+") top center no-repeat",t.style.backgroundSize="contain",this.thumbnail=t)},this.initScreenPlayBtn=function(){this.screenPlayBtn&&(this.screenPlayBtn=$ts.ce({tag:"div",class:"screenPlayBtn",parent:this.container}),this.screenPlayBtn.addEventListener("click",function(){this.media.paused?this.play():this.pause()}.bind(this)),$ts.addHoverEvents(this.screenPlayBtn),this.screenPlayBtn.addEventListener("click",$efSound.click))},this.set=function(){var t;this.container.classList.add(this.mediaType),this.initThumnail(),this.initScreenPlayBtn(),this.setBookmark(),"control"===this.controlType&&this.container.classList.add("on"),"speaker"===this.controlType&&(t=this.container.getAttribute("data-speaker-media"),this.speaker=$ts.getEl('[data-speaker="'+t+'"]')[0]),this.autoPlay&&1==this.playPage&&this.startAutoPlay(this.media.getAttribute("data-auto-play")),this.volumeControl&&window.$run("$volumeControl",function(){window.$volumeControl(this)}),this.getDuration(),this.media.addEventListener("ended",this.stop.bind(this)),this.media.addEventListener("playing",function(){r.isPlaying=!0,r.isPlay=!0,r.removeStoppedClass()}),this.create().addEvent(),this.addStoppedClass()},this.getDuration=function(){var t=setInterval(function(){r.media.readyState&&(clearInterval(t),r.mediaDuration=r.media.duration,r.timer())})},this.fullScreenOff=function(){this.SHOW_CONTROLS_ON_FULLSIZE||this.controlsOff(),this.container.classList.remove(e),this.media.paused?this.isPlayOff():this.isPlayOn(),this.media.muted?this.muteBtn.classList.add("on"):this.muteBtn.classList.remove("on")},this.fullScreenOn=function(){this.container.classList.add(e),this.SHOW_CONTROLS_ON_FULLSIZE||this.controlsOn()},this.controlsOn=function(){this.media.setAttribute("controls","")},this.controlsOff=function(){this.media.removeAttribute("controls")},this.isPlayOn=function(){this.container.classList.add("isPlay")},this.isPlayOff=function(){this.container.classList.remove("isPlay")},this.onTimeupdate=function(){this.media.currentTime?this.removeStoppedClass():this.addStoppedClass()},this.addStoppedClass=function(){this.container.classList.add(i)},this.removeStoppedClass=function(){this.container.classList.remove(i)},this.set()}window.$controller=function(t){return new n(t)}}(),function(){function e(t){var c,h=this;this.type=t.type,this.index=t.index,this.syncData=t.sync,this.syncIndex=0,this.element=t.sync.element||!1,this.preObjview=t.preObjview||!1,this.bringToFront=void 0===t.bringToFront||t.bringToFront,this.mediaIndex=t.mediaIndex||!1,"musicSync"===this.type&&(c=t.sync),this.createCation=function(){this.captionBtn=this.mediaController.captionBtn,this.captionContainer=$ts.ce({tag:"div",class:"captionContainer",parent:this.mediaController.container}),this.captionText=$ts.ce({tag:"div",class:"captionText",parent:this.captionContainer}),this.captionText.innerHTML=this.syncData.text[0].text},this.addEvent=function(){this.captionBtn&&(this.captionBtn.classList.add("on"),this.captionBtn.addEventListener("click",this.toggleCaption.bind(this)),$ts.addHoverEvents(this.captionBtn),this.captionBtn.addEventListener("click",$efSound.click))},this.toggleCaption=function(){this.captionContainer.classList.contains("on")?this.captionContainer.classList.remove("on"):this.captionContainer.classList.add("on")},this.getSyncTarget=function(){for(var t=$ts.getEl('[data-sync-container="'+this.syncData.container+'"]')[0],e=this.element?$ts.getEl(this.element,t):$ts.getEl("[data-sync-target]",t),i=this.element?this.element.replace("[","").replace("]",""):"data-sync-target",n=new Array(this.syncData.time.length),s=0;s<n.length;s++)n[s]=[];for(s in e)n[e[s].getAttribute(i)-1].push(e[s]);this.syncData.target=n,this.syncData.targetOn=$ts.getEl("[data-target-on]",t)},this.syncPlay=function(){this.syncAni&&clearInterval(this.syncAni),this.mediaIndex&&this.mediaIndex!=this.mediaController.media.getAttribute("data-media-index")||(this.syncAni=setInterval(function(){var t=h.syncIndex;if(h.syncIndex=h.getSyncIndex(),null==h.syncIndex)h.clearSync();else if(t!==h.syncIndex){if(h.preObjview){h.clearSync();for(var e=0;e<h.syncIndex;e++)h.addClass({target:h.syncData.target[e],class:"on"})}else h.clearSync({targetIdx:t});h.activeSync(h.syncIndex)}else this.syncAni&&clearInterval(this.syncAni)},2))},this.getSyncIndex=function(t){var e,t=h.mediaController.media.currentTime,i=null;for(e in this.syncData.time)t>=this.syncData.time[e][0]&&t<this.syncData.time[e][1]&&(i=e);return i},this.activeSync=function(t){h.preObjview||this.clearSync(),"caption"===this.type?this.captionText.innerHTML=this.syncData.text[t].text:"rolePlay"===this.type||("target"===this.type?(this.addClass({target:this.syncData.target[t],class:"on"}),this.syncData.callbacks.activeSync&&this.syncData.callbacks.activeSync(this.syncData.target[t])):"imageSwitch"===this.type?this.syncData.target.src=this.syncData.images[t]:"musicSync"===this.type&&(t=this.syncData.target[t],this.addClass({target:t,class:"on"}),t&&this.bringToFront&&t[0].parentNode.appendChild(t[0])))},this.clearSync=function(t){if("caption"===this.type)this.captionText.innerHTML="";else if("rolePlay"===this.type)this.muted(!1);else if("target"===this.type||"musicSync"===this.type)if(t&&t.targetIdx)this.removeClass({target:this.syncData.target[t.targetIdx],class:"on"}),this.syncData.callbacks.clearSync&&this.syncData.callbacks.clearSync(this.syncData.target[t.targetIdx]);else for(var e in this.syncData.target)this.removeClass({target:this.syncData.target[e],class:"on"});else"imageSwitch"===this.type&&(this.syncData.target.src="");this.mediaController.isPlaying||clearInterval(this.syncAni)},this.syncPause=function(){clearInterval(this.syncAni)},this.addClass=function(t){for(var e in t.target){e=t.target[e];e.classList?e.classList.add(t.class):e.className.baseVal?e.className.baseVal=e.className.baseVal+" "+t.class:e.className.baseVal=t.class}},this.removeClass=function(t){for(var e in t.target){var i,n=t.target[e];n.classList?n.classList.remove(t.class):(e=(i=n.className.baseVal).indexOf(t.class),i.length===t.class.length?n.className.baseVal="":0===e?n.className.baseVal=i.slice(t.class.length+1,i.length):e+t.class.length===i.length?n.className.baseVal=i.slice(0,e-1):n.className.baseVal=i.slice(0,e-1)+i.slice(e,i.length))}},this.switchClass=function(t){for(var e in t.target)t.target[e].className=t.target[e].className.replace(t.currentClass,t.changeClass)},this.syncEnd=function(){this.syncAni&&clearInterval(this.syncAni),this.clearSync(),this.syncIndex=0,"target"===this.type&&this.syncData.targetOn&&this.addClass({target:this.syncData.targetOn,class:"on"})},this.muted=function(t){t?(this.mediaController.media.muted=!0,this.mediaController.media.volume=0):(this.mediaController.media.muted=!1,this.mediaController.media.volume=this.mediaController.volume)},this.reset=function(){this.syncEnd(),this.captionContainer&&this.captionContainer.classList.remove("on")},this.getMedia=function(i){var n=this,s=window.setInterval(function(){var t=window.$pm.array.controller;if(t){for(var e in window.clearInterval(s),t)parseInt(t[e].mediaSync)===n.index&&(n.mediaController=t[e]);i()}})},this.setMusicSync=function(){var s,a,r,e,o;this.svgs=c.svgs,this.svgElement=document,this.noteKey=c.noteKey,this.noteName=c.noteName||"#bar_",this.startTime=c.start,this.endTime=c.end,this.noteCount=c.noteSyncData.length,this.noteSyncData=c.noteSyncData,this.meter=c.meter,this.mode=c.mode,this.speedAdjust=c.speedAdjust,this.beat=(this.endTime-this.startTime)/this.noteCount+this.speedAdjust,s=0,a=[],h.svgs.forEach(function(t,e){for(var i=document.querySelector("#"+t).querySelector(h.noteName+(e+1)),n=0;n<i.children.length;n++)"#text"!==i.children[n].nodeName&&"true"!==i.children[n].getAttribute("pass")&&(i.children[n].setAttribute("id",h.getNoteId(s)),i.children[n].setAttribute("svgId",e+1),a.push([i.children[n]]),s++)}),h.syncData.target=a,o=[],h.noteSyncData.forEach(function(t,i){var n=null;c.bridge?c.bridge.forEach(function(t,e){r>=t.start&&r<t.end?(r=t.end,n=n||i):n&&n===i||(r=0==i?h.startTime:o[i-1][1])}):r=0==i?h.startTime:o[i-1][1],e=r+t*h.beat,o.push([r,e])}),h.syncData.time=o},this.getNoteId=function(t){t+=1;return t=t<10?this.noteKey+"00"+t:t<100?this.noteKey+"0"+t:this.noteKey+t},this.addMediaEvent=function(){this.mediaController.media.removeEventListener("play",this.syncPlay.bind(this)),this.mediaController.media.removeEventListener("ended",this.syncEnd.bind(this)),this.mediaController.handleBar.removeEventListener("click",this.syncPlay.bind(this)),this.mediaController.pauseBtn.removeEventListener("click",this.syncPause.bind(this)),this.mediaController.stopBtn.removeEventListener("click",this.syncEnd.bind(this)),this.mediaController.media.addEventListener("play",this.syncPlay.bind(this)),this.mediaController.media.addEventListener("ended",this.syncEnd.bind(this)),this.mediaController.handleBar.addEventListener("click",this.syncPlay.bind(this)),this.mediaController.pauseBtn.addEventListener("click",this.syncPause.bind(this)),this.mediaController.stopBtn.addEventListener("click",this.syncEnd.bind(this))},this.set=function(){var e=this,i=$ts.getEl("[data-media-btn]");this.getMedia(function(){if("caption"===e.type?(e.createCation(),e.addEvent()):"rolePlay"===e.type?e.createRolePlay():"target"===e.type?e.getSyncTarget():"imageChange"===e.type||"musicSync"===e.type&&e.setMusicSync(),e.addMediaEvent(),i)for(var t in i)i[t].addEventListener("click",e.addMediaEvent.bind(e)),i[t].addEventListener("click",e.syncEnd.bind(e));"speaker"===e.mediaController.controlType&&e.mediaController.speaker.addEventListener("click",e.syncEnd.bind(e))})},this.set()}window.$rolePlay=function(t){return new e(t)}}(),function(){function e(t){var s=this;this.container=t.container,this.mediaController=t.controller,this.volume=t.volume,this.create=function(){return this.volumeContainer=$ts.ce({tag:"div",class:"volumeContainer",parent:this.controller}),this.muteBtn=$ts.ce({tag:"div",class:"muteBtn",parent:this.volumeContainer}),this.handleBar=$ts.ce({tag:"div",class:"handleBar",parent:this.volumeContainer}),this.handleColorBar=$ts.ce({tag:"div",class:"handleColorBar",parent:this.handleBar}),this.handler=$ts.ce({tag:"div",class:"handler",parent:this.handleBar}),this},this.addEvent=function(){this.handleBar.addEventListener("click",this.clickBar.bind(this)),this.handler.addEventListener("mousedown",this.dragHandler.bind(this)),this.handler.addEventListener("touchstart",this.dragHandler.bind(this))},this.reset=function(){},this.getData=function(){var t={};return t.barSize=this.handleBar.getBoundingClientRect(),t.barTotalSize=t.barSize.right-t.barSize.left,t.handlerWidth=this.handler.getBoundingClientRect().width/2,t},this.clickBar=function(t){var e=this.getData();this.LEFT=("touchstart"===t.type?t.touches[0]:t).clientX,e.changeLeftValue=this.LEFT-e.barSize.left,e.rate=e.changeLeftValue/e.barTotalSize*100,this.changeHandlerPosition(e),this.changeCurTime(e)},this.dragHandler=function(t){var e=s.getData();function i(t){s.LEFT=("touchmove"===t.type?t.touches[0]:t).clientX,e.changeLeftValue=s.LEFT-e.barSize.left,e.rate=e.changeLeftValue/e.barTotalSize*100,s.changeHandlerPosition(e),s.changeCurTime(e)}function n(){document.removeEventListener("mousemove",i),document.removeEventListener("touchmove",i),document.removeEventListener("mouseup",n),document.removeEventListener("touchend",n)}s.LEFT=("touchstart"===t.type?t.touches[0]:t).clientX,document.addEventListener("mousemove",i),document.addEventListener("touchmove",i),document.addEventListener("mouseup",n),document.addEventListener("touchend",n)},this.changeHandlerPosition=function(t){var e=t.changeLeftValue/$pm.zoomRate;t.rate<0?e=null:100<t.rate&&(e=t.barSize.width/$pm.zoomRate),this.handler.style.transform="translateX("+e+"px)",this.handler.style.msTransform="translateX("+e+"px)",this.handler.style.mozTransform="translateX("+e+"px)",this.handler.style.webkitTransform="translateX("+e+"px)",this.handleColorBar.style.width=100<t.rate?"100%":t.rate+"%"},this.changeCurTime=function(t){var e=isNaN(this.media.duration)?this.mediaDuration:this.media.duration;this.media.currentTime=e*(t.rate/100)},this.set=function(){this.create().addEvent()},this.set()}window.$volume=function(t){return new e(t)}}(),function(){function e(t){var s=this;this.parent=t.parent,this.media=t.media,this.volumeLevel=1,this.prevVolumeLevel=1,this.prevHandlerRate=0,this.create=function(){return this.volumeContainer=$ts.ce({tag:"div",class:"volumeContainer",parent:this.parent}),this.muteBtn=$ts.ce({tag:"div",class:"muteBtn",parent:this.volumeContainer}),this.handleBar=$ts.ce({tag:"div",class:"handleBar",parent:this.volumeContainer}),this.handleColorBar=$ts.ce({tag:"div",class:"handleColorBar",parent:this.handleBar}),this.handler=$ts.ce({tag:"div",class:"handler",parent:this.handleBar}),this},this.addEvent=function(){this.muteBtn.addEventListener("click",this.clickMute.bind(this)),this.muteBtn.addEventListener("click",$efSound.click),this.handleBar.addEventListener("click",this.clickBar.bind(this)),this.handler.addEventListener("mousedown",this.dragHandler.bind(this)),this.handler.addEventListener("touchstart",this.dragHandler.bind(this)),$ts.addHoverEvents(this.volumeContainer)},this.reset=function(){},this.getData=function(){var t={};return t.barSize=this.handleBar.getBoundingClientRect(),t.barTotalSize=t.barSize.bottom-t.barSize.top,t.handlerHeight=this.handler.getBoundingClientRect().height/2,t},this.clickBar=function(t){var e=this.getData();this.TOP=("touchstart"===t.type?t.touches[0]:t).clientY,e.changeTOPValue=this.TOP-e.barSize.top,e.rate=e.changeTOPValue/e.barTotalSize*100,this.changeHandlerPosition(e),this.changeVolume(this.getVolume(e))},this.clickMute=function(t){var e=this.getData();0===this.volumeLevel?(e.rate=this.prevHandlerRate,this.changeHandlerPosition(e),this.changeVolume(this.prevVolumeLevel)):(this.changeHandlerPosition(),this.changeVolume(0))},this.dragHandler=function(t){var e=s.getData();function i(t){s.TOP=("touchmove"===t.type?t.touches[0]:t).clientY,e.changeTOPValue=s.TOP-e.barSize.top,e.rate=e.changeTOPValue/e.barTotalSize*100,s.changeHandlerPosition(e),s.changeVolume(s.getVolume(e))}function n(){document.removeEventListener("mousemove",i),document.removeEventListener("touchmove",i),document.removeEventListener("mouseup",n),document.removeEventListener("touchend",n)}s.TOP=("touchstart"===t.type?t.touches[0]:t).clientY,document.addEventListener("mousemove",i),document.addEventListener("touchmove",i),document.addEventListener("mouseup",n),document.addEventListener("touchend",n)},this.changeHandlerPosition=function(t){var e;t?(this.prevHandlerRate=t.rate,e=(e=100<t.rate?100:t.rate)<0?0:e):handlerTop=e=100,this.handler.style.transform="translateY("+e+"px)",this.handler.style.msTransform="translateY("+e+"px)",this.handler.style.mozTransform="translateY("+e+"px)",this.handler.style.webkitTransform="translateY("+e+"px)",this.handleColorBar.style.height="".concat(100-e,"%"),this.handleColorBar.style.marginTop="".concat(e,"px")},this.getVolume=function(t){t=100<t.rate?100:t.rate;return(100-(t=t<0?0:t))/100},this.changeVolume=function(t){this.prevVolumeLevel=this.volumeLevel,this.volumeLevel=t,0===(this.media.volume=t)?this.muteBtn.classList.add("mute"):this.muteBtn.classList.remove("mute")},this.set=function(){this.create().addEvent()},this.set()}window.$volume2=function(t){return new e(t)}}(),function(t){t&&t.prototype&&null==t.prototype.children&&Object.defineProperty(t.prototype,"children",{get:function(){for(var t,e=0,i=this.childNodes,n=[];t=i[e++];)1===t.nodeType&&n.push(t);return n}})}(window.Node||window.Element);