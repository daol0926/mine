"use strict";!function(){var e=116;function v(){return $pm.zoomRate||1}function i(t,o){return parseFloat(t.toPrecision(o))}function L(t){var o=t.top,e=t.left,i=t.container,n=t.dragObject,s=parseFloat(n.style.transform.split("scale(")[1].split(")")[0]),m=(n.clientHeight*s-i.clientHeight)/2,a=(n.clientWidth*s-i.clientWidth)/2,t=(i.clientHeight-n.clientHeight*s)/2,i=(i.clientWidth-n.clientWidth*s)/2,n=o<t,s=e<i;return m<o&&(o=m),a<e&&(e=a),{top:o=n?t:o,left:e=s?i:e}}function o(t){this.container=t,this.maxZoom=this.container.hasAttribute("maxZoom")?parseInt(this.container.getAttribute("maxZoom")):2,this.zoomImg=this.container.querySelector(".zoomImgContainer"),this.zoomImgPosition={top:this.zoomImg.offsetTop,left:this.zoomImg.offsetLeft},this.zoomController=$ts.ce({tag:"div",class:"zoomController",parent:this.container}),this.container.classList.contains("vertical")?(this.zoomPlus=$ts.ce({tag:"div",class:"zoomPlus",parent:this.zoomController}),this.zoomBar=$ts.ce({tag:"div",class:"zoomBar",parent:this.zoomController}),this.zoomMinus=$ts.ce({tag:"div",class:"zoomMinus",parent:this.zoomController})):(this.zoomMinus=$ts.ce({tag:"div",class:"zoomMinus",parent:this.zoomController}),this.zoomBar=$ts.ce({tag:"div",class:"zoomBar",parent:this.zoomController}),this.zoomPlus=$ts.ce({tag:"div",class:"zoomPlus",parent:this.zoomController})),this.zoomOut=$ts.ce({tag:"div",class:"zoomOut",parent:this.zoomController}),this.zoomSpin=$ts.ce({tag:"div",class:"zoomSpin",parent:this.zoomBar}),this.zoomSpinLeft=0===this.zoomSpin.offsetLeft?9:this.zoomSpin.offsetLeft,this.zoomSpinTop=0===this.zoomSpin.offsetTop?9:this.zoomSpin.offsetTop,this.zoomSpinMaxLeft=e+this.zoomSpinLeft,this.zoomSpinMaxTop=e+this.zoomSpinTop,this.imageZoomRate=1,this.resetNotWorking=!!this.container.hasAttribute("data-no-reset"),this.zoomImg.style.position="absolute",this.addEvent=function(){new n({container:this.container,element:this.zoomImg,block:{top:50},target:"main"}),new n({element:this.zoomSpin,type:this.container.classList.contains("vertical")?"vertical":"horizon",limit:{left:this.zoomSpinLeft,right:this.zoomSpinMaxLeft,top:this.zoomSpinTop,bottom:this.zoomSpinMaxTop},callBack:this.changeSpin.bind(this)})},this.zoomPlus.addEventListener("click",this.plusZoom.bind(this)),this.zoomMinus.addEventListener("click",this.minusZoom.bind(this)),this.zoomOut.addEventListener("click",this.resetZoom.bind(this)),this.zoomPlus.addEventListener("click",$efSound.click),this.zoomMinus.addEventListener("click",$efSound.click),this.zoomOut.addEventListener("click",$efSound.click),this.container.addEventListener("mouseover",this.addWheelEvent.bind(this)),this.container.addEventListener("mouseout",this.removeWheelEvent.bind(this)),this.addEvent(),this.zoomImg.classList.add("pointerOff"),Object.defineProperties(this,{containerSize:{get:function(){return this.container.getBoundingClientRect()}},zoomImageSize:{get:function(){return this.zoomImg.getBoundingClientRect()}}})}function t(t){var o;t.wheelDelta?(o=event.wheelDelta,window.opera&&(o=-o)):t.detail&&(o=-event.detail/3),o<0?this.minusZoom():this.plusZoom()}function n(t){var f=t.container,g=t.element,u=t,z=u.type||"all";this.startDrag=function(t){var s={top:u.limit&&u.limit.top?u.limit.top:null,left:u.limit&&u.limit.left?u.limit.left:null,right:u.limit&&u.limit.right?u.limit.right:null,bottom:u.limit&&u.limit.bottom?u.limit.bottom:null},o={top:0,left:0,right:0,bottom:0},m=u.callBack||null,a={top:g.offsetTop,left:g.offsetLeft},e=g.getBoundingClientRect().top,i=g.getBoundingClientRect().left,n=g.getBoundingClientRect().left+g.getBoundingClientRect().width,l=g.getBoundingClientRect().top+g.getBoundingClientRect().height,h=t.clientX,r=t.clientY,c=u.target,p=function(t){var o=t.clientX-h,e=t.clientY-r,i="",n={top:!1,left:!1},i="main"===c?a.top+e/v():a.top-e/v(),o=a.left+o/v();"main"===c&&(n=L({top:i,left:o,container:f,dragObject:g})),"horizon"!==z&&(s.top&&i<s.top?i=s.top:s.bottom&&i>s.bottom&&(i=s.bottom),"main"===c&&!1!==n.top?g.style.top=n.top+"px":g.style.top=i+"px"),"vertical"!==z&&(s.left&&o<s.left?o=s.left:s.right&&o>s.right&&(o=s.right),"main"===c&&!1!==f.left?g.style.left=n.left+"px":g.style.left=o+"px"),(t.clientX<0||t.clientX>window.innerWidth||t.clientY<0||t.clientY>window.innerHeight)&&d(),m&&m(g)},d=function t(o){document.removeEventListener("mousemove",p),document.removeEventListener("touchmove",p),document.removeEventListener("mouseup",t),document.removeEventListener("touchend",t)};u.block&&(o={top:u.block.top||0,left:u.block.left||0,right:u.block.right||0,bottom:u.block.bottom||0}),t.clientX<i+o.left||t.clientX>n-o.right||t.clientY<e+o.top||t.clientY>l-o.bottom?d(t):(document.addEventListener("mousemove",p),document.addEventListener("touchmove",p),document.addEventListener("mouseup",d),document.addEventListener("touchend",d))},g.addEventListener("mousedown",this.startDrag.bind(this)),g.addEventListener("touchstart",this.startDrag.bind(this))}o.prototype.addWheelEvent=function(){window.addEventListener&&window.addEventListener("DOMMouseScroll",t),window.onmousewheel=document.onmousewheel=t.bind(this)},o.prototype.removeWheelEvent=function(){window.addEventListener&&window.removeEventListener("DOMMouseScroll",t)},o.prototype.plusZoom=function(){this.imageZoomRate=this.imageZoomRate>=this.maxZoom?this.maxZoom:i(this.imageZoomRate+.1,2),this.changeSpin()},o.prototype.minusZoom=function(){this.imageZoomRate=this.imageZoomRate<=1?1:i(this.imageZoomRate-.1,2),this.changeSpin()},o.prototype.changeZoomImage=function(){var t,o;this.zoomImg.style.transform="scale("+this.imageZoomRate+")",this.zoomImg.style.MsTransform="scale("+this.imageZoomRate+")",this.zoomImg.style.MozTransform="scale("+this.imageZoomRate+")",this.zoomImg.style.WebkitTransform="scale("+this.imageZoomRate+")",1===this.imageZoomRate?(this.resetPosition(),this.zoomImg.classList.add("pointerOff")):this.zoomImg.classList.remove("pointerOff"),t={container:this.container,dragObject:this.zoomImg,left:this.zoomImg.offsetLeft,top:this.zoomImg.offsetTop},o=L(t),t.dragObject.style.left=o.left+"px",t.dragObject.style.top=o.top+"px"},o.prototype.changeSpin=function(t){var o;this.container.classList.contains("vertical")?(void 0!==t&&(this.imageZoomRate=(t.offsetTop-this.zoomSpinTop)/e+1),o=this.zoomSpinTop+e*i((this.imageZoomRate-1)/(this.maxZoom-1),2),this.zoomSpin.style.top=this.zoomSpinMaxTop<=o?this.zoomSpinMaxTop+"px":o+"px"):(void 0!==t&&(this.imageZoomRate=(t.offsetLeft-this.zoomSpinLeft)/e+1),t=this.zoomSpinLeft+e*i((this.imageZoomRate-1)/(this.maxZoom-1),2),this.zoomSpin.style.left=this.zoomSpinMaxLeft<=t?this.zoomSpinMaxLeft+"px":t+"px"),this.changeZoomImage()},o.prototype.resetPosition=function(){this.zoomImg.style.top=this.zoomImgPosition.top+"px",this.zoomImg.style.left=this.zoomImgPosition.left+"px"},o.prototype.resetZoom=function(){this.imageZoomRate=1,this.changeSpin()},window.$zoom=function(t){return new o(t)}}();