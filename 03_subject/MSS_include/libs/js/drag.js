"use strict";window.$Drag=function(t){var m,o,p=this,g=t.type||"all",f=t.dragObj,L=t.container||document;t.callBack&&(m=t.callBack.move||null,o=t.callBack.end||null),this.startDrag=function(t){t.stopPropagation();var u=$pm.zoomRate||1,d=("touchstart"==t.type?t.touches[0]:t).clientY,v=("touchstart"==t.type?t.touches[0]:t).clientX,l=f.offsetTop,h=f.offsetLeft;function e(t){var e=("touchmove"==t.type?t.touches[0]:t).clientY,n=("touchmove"==t.type?t.touches[0]:t).clientX,o=(e-d)/u+l,i=(n-v)/u+h;p.newY=o,p.newX=i;var r,a,s=void 0,c=void 0;f.dataset.popupPage&&(a=(r=L.querySelector("#wrap")).querySelector("header"),t=r.querySelector("main"),e=r.getBoundingClientRect(),n=a&&a.getBoundingClientRect(),r=t.getBoundingClientRect(),a=f.getBoundingClientRect(),t=(n||r).top,t-=e.top,n=r.left-e.left,e=r.width-a.width,r=r.bottom-a.height,(a=i*u)<=n&&(c=n/u),e<=a&&(c=e/u),(e=o*u)<=t&&(s=t/u),r<=e&&(s=r/u)),"horizon"!==g&&(f.style.top=parseInt(void 0===s?o:s)+"px"),"vertical"!==g&&(f.style.left=parseInt(void 0===c?i:c)+"px"),m&&m(p)}function n(){L.removeEventListener("mousemove",e),L.removeEventListener("touchmove",e),document.removeEventListener("mouseup",n),document.removeEventListener("touchend",n),o&&o(p)}f.style.transition="none",L.addEventListener("mousemove",e),L.addEventListener("touchmove",e),document.addEventListener("mouseup",n),document.addEventListener("touchend",n)},f.addEventListener("mousedown",this.startDrag.bind(this)),f.addEventListener("touchstart",this.startDrag.bind(this)),L.addEventListener("touchstart",function(t){t.stopPropagation()})};